{"ast":null,"code":"var _jsxFileName = \"/home/relic/capstone-two/frontend/src/context/UserContextProvider.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport UserContext from \"./UserContext\";\nimport { useNavigate } from \"react-router\";\nimport DnDApi from '../api';\nimport useLocalStorage from '../hooks/useLocalStorage';\nimport jwt_decode from \"jwt-decode\";\nimport LoadingSpinner from '../components/common/LoadingSpinner';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const TOKEN_STORAGE_ID = \"dnd-token\";\nfunction UserContextProvider({\n  children\n}) {\n  _s();\n  const [isLoading, setIsLoading] = useState(true);\n  const [currentUser, setCurrentUser] = useState('');\n  const [token, setToken] = useLocalStorage(TOKEN_STORAGE_ID);\n  const [userData, setUserData] = useState('');\n  const navigate = useNavigate();\n  async function registerUser(signUpData) {\n    try {\n      let token = await DnDApi.register(signUpData);\n      setToken(token);\n      return {\n        success: true\n      };\n    } catch (err) {\n      console.error('signup failed', err);\n      return {\n        success: false,\n        err\n      };\n    }\n  }\n  async function loginUser(loginData) {\n    try {\n      let token = await DnDApi.login(loginData);\n      setToken(token);\n      return {\n        success: true\n      };\n    } catch (err) {\n      console.log(err);\n      return {\n        success: false,\n        err\n      };\n    }\n  }\n  async function updateUser(editData) {\n    try {\n      let newUserData = await DnDApi.editCurrentUser(currentUser.username, editData);\n      setCurrentUser(newUserData);\n      navigate('/');\n      return {\n        success: true\n      };\n    } catch (err) {\n      console.log(err);\n      return {\n        success: false,\n        err\n      };\n    }\n  }\n  async function getCurrentUser(username) {\n    try {\n      const user = await DnDApi.getCurrentUser(username);\n      setUserData(user);\n    } catch (err) {\n      console.error('Error: ', err);\n      if (err[0] === 'Unauthorized') {\n        return logout();\n      }\n    }\n  }\n  const logout = () => {\n    setCurrentUser('');\n    setToken('');\n    navigate('/');\n  };\n  const onHomepage = window.location.pathname === '/';\n  if (isLoading && !onHomepage) return /*#__PURE__*/_jsxDEV(LoadingSpinner, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 77,\n    columnNumber: 42\n  }, this);\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: {\n      isLoading,\n      token,\n      currentUser,\n      getCurrentUser,\n      userData,\n      registerUser,\n      loginUser,\n      updateUser,\n      logout,\n      navigate,\n      deleteUser\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 9\n  }, this);\n}\n_s(UserContextProvider, \"bDfLwEmNFI69TC+Ft99LOsP1Pqs=\", false, function () {\n  return [useLocalStorage, useNavigate];\n});\n_c = UserContextProvider;\nexport default UserContextProvider;\nvar _c;\n$RefreshReg$(_c, \"UserContextProvider\");","map":{"version":3,"names":["React","useState","useEffect","UserContext","useNavigate","DnDApi","useLocalStorage","jwt_decode","LoadingSpinner","jsxDEV","_jsxDEV","TOKEN_STORAGE_ID","UserContextProvider","children","_s","isLoading","setIsLoading","currentUser","setCurrentUser","token","setToken","userData","setUserData","navigate","registerUser","signUpData","register","success","err","console","error","loginUser","loginData","login","log","updateUser","editData","newUserData","editCurrentUser","username","getCurrentUser","user","logout","onHomepage","window","location","pathname","fileName","_jsxFileName","lineNumber","columnNumber","Provider","value","deleteUser","_c","$RefreshReg$"],"sources":["/home/relic/capstone-two/frontend/src/context/UserContextProvider.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport UserContext from \"./UserContext\";\nimport { useNavigate } from \"react-router\"\nimport DnDApi from '../api'\nimport useLocalStorage from '../hooks/useLocalStorage'\nimport jwt_decode from \"jwt-decode\"\nimport LoadingSpinner from '../components/common/LoadingSpinner'\n\nexport const TOKEN_STORAGE_ID = \"dnd-token\";\n\nfunction UserContextProvider({ children }) {\n    const [isLoading, setIsLoading] = useState(true)\n    const [currentUser, setCurrentUser] = useState('')\n    const [token, setToken] = useLocalStorage(TOKEN_STORAGE_ID)\n    const [userData, setUserData] = useState('');\n\n    const navigate = useNavigate()\n\n    async function registerUser(signUpData) {\n        try {\n            let token = await DnDApi.register(signUpData)\n            setToken(token)\n            return { success: true }\n        } catch (err) {\n            console.error('signup failed', err)\n            return { success: false, err }\n        }\n    }\n\n    async function loginUser(loginData) {\n        try {\n            let token = await DnDApi.login(loginData)\n            setToken(token)\n            return { success: true }\n        } catch (err) {\n            console.log(err)\n            return { success: false, err }\n        }\n    }\n\n    async function updateUser(editData) {\n        try {\n            let newUserData = await DnDApi.editCurrentUser(\n                currentUser.username, editData\n            )\n            setCurrentUser(newUserData)\n            navigate('/')\n            return { success: true }\n        } catch (err) {\n            console.log(err)\n            return { success: false, err }\n        }\n    }\n\n\n    async function getCurrentUser(username) {\n        try {\n            const user = await DnDApi.getCurrentUser(username);\n            setUserData(user);\n        } catch (err) {\n            console.error('Error: ', err);\n            if (err[0] === 'Unauthorized') {\n                return logout();\n            }\n        }\n    }\n\n\n    const logout = () => {\n        setCurrentUser('')\n        setToken('')\n        navigate('/')\n    }\n\n    const onHomepage = window.location.pathname === '/'\n\n    if (isLoading && !onHomepage) return <LoadingSpinner />\n\n    return (\n        <UserContext.Provider\n            value={\n                {\n                    isLoading,\n                    token,\n                    currentUser,\n                    getCurrentUser,\n                    userData,\n                    registerUser,\n                    loginUser,\n                    updateUser,\n                    logout,\n                    navigate,\n                    deleteUser,\n                }\n            }\n        >\n            {children}\n        </UserContext.Provider>\n    )\n}\n\nexport default UserContextProvider"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}